---
description: 
globs: **/Aqt.CoreOracle.Application.Contracts/**/*.cs
alwaysApply: false
---
# Rule: Chuáº©n hÃ³a táº§ng Aqt.CoreOracle.Application.Contracts

## Context

Táº§ng `Application.Contracts` Ä‘á»‹nh nghÄ©a **há»£p Ä‘á»“ng giao tiáº¿p (contract)** giá»¯a cÃ¡c táº§ng `Application`, `HttpApi`, `Client`, vÃ  cáº£ `Web`.  
ÄÃ¢y lÃ  nÆ¡i khai bÃ¡o **DTO**, **interface AppService**, **permission names**, **API contracts**, **validation input**, vÃ  **háº±ng sá»‘ Ä‘á»‹nh danh**.

**Táº§ng nÃ y khÃ´ng chá»©a logic xá»­ lÃ½.** Chá»‰ dÃ¹ng Ä‘á»ƒ chia sáº» há»£p Ä‘á»“ng vÃ  dá»¯ liá»‡u.

## Requirements

### ğŸ“ Cáº¥u trÃºc thÆ° má»¥c

- âœ… PhÃ¢n tÃ¡ch rÃµ: `Dtos/`, `Permissions/`, `Requests/`, `Responses/`, `Services/`
- âŒ KhÃ´ng cÃ³ Entity, Repository, hoáº·c xá»­ lÃ½ logic

#### âœ”ï¸ NÃªn:
- DÃ¹ng háº­u tá»‘ `Dto`, `Input`, `Output` cho DTO
- Äáº·t Permission táº¡i `Permissions/ModulePermissions.cs`

### ğŸ“¦ Namespace chuáº©n

- âœ… Dáº¡ng: `Aqt.CoreOracle.Application.Contracts.[Module].[Role]`
- âŒ KhÃ´ng dÃ¹ng `Domain`, `Shared`, hoáº·c namespace khÃ¡c lá»‡ch táº§ng

ğŸ“Œ VÃ­ dá»¥:
```csharp
namespace Aqt.CoreOracle.Application.Contracts.Orders.Dtos;
```

### ğŸ“¦ AppService Interface

- âœ… Interface káº¿ thá»«a tá»« `IApplicationService`
- âœ… Náº±m trong Contracts, khÃ´ng cÃ³ implement
- âŒ KhÃ´ng khai bÃ¡o logic hoáº·c method ná»™i bá»™

ğŸ“Œ VÃ­ dá»¥:
```csharp
public interface IOrderAppService : IApplicationService
{
    Task<OrderDto> GetAsync(Guid id);
}
```

### ğŸ“‘ DTO

- âœ… DÃ¹ng háº­u tá»‘: `Dto`, `CreateUpdateDto`, `Input`, `Output`
- âœ… Chá»©a dá»¯ liá»‡u vÃ  DataAnnotations (VD: `[Required]`)
- âŒ KhÃ´ng chá»©a xá»­ lÃ½ logic hoáº·c gá»i service

### ğŸ” Permissions

- âœ… Äá»‹nh nghÄ©a táº¡i `Permissions/CoreOraclePermissions.cs`
- âœ… Sá»­ dá»¥ng format: `"CoreOracle.ModuleName.Action"`

ğŸ“Œ VÃ­ dá»¥:
```csharp
public static class OrderPermissions
{
    public const string GroupName = "Orders";
    public const string Default = GroupName;
    public const string Create = GroupName + ".Create";
}
```

### ğŸ” Permission Definitions

- âœ… Äá»‹nh nghÄ©a toÃ n bá»™ cÃ¢y permission táº¡i `CoreOraclePermissions.cs`
- âœ… DÃ¹ng `GroupName = "CoreOracle"` lÃ m prefix chung cho táº¥t cáº£ quyá»n
- âœ… Tá»• chá»©c permission theo module báº±ng nested static class (VD: `Orders`, `Settings`)
- âœ… DÃ¹ng format chuáº©n: `"CoreOracle.Module.Action"`
- âœ… Sá»­ dá»¥ng `PermissionDefinitionProvider` Ä‘á»ƒ Ä‘Äƒng kÃ½ quyá»n tá»« constants nÃ y
- âŒ KhÃ´ng nÃªn hardcode permission key trá»±c tiáº¿p trong AppService
- âŒ KhÃ´ng nÃªn viáº¿t logic trong file permission

ğŸ“Œ VÃ­ dá»¥:
```csharp
public static class CoreOraclePermissions
{
    public const string GroupName = "CoreOracle";

    public static class Orders
    {
        public const string Default = GroupName + ".Orders";
        public const string Create = Default + ".Create";
        public const string Delete = Default + ".Delete";
    }

    public static class Settings
    {
        public const string Manage = GroupName + ".Settings.Manage";
    }
}
```

ğŸ“Œ Sá»­ dá»¥ng trong AppService:
```csharp
[Authorize(CoreOraclePermissions.Orders.Create)]
public async Task CreateAsync(...) { ... }
```

ğŸ“Œ Sá»­ dá»¥ng trong PermissionDefinitionProvider:
```csharp
var group = context.AddGroup(CoreOraclePermissions.GroupName);
group.AddPermission(CoreOraclePermissions.Orders.Create);
```

### ğŸ§© Interface AppService

Interface trong `Application.Contracts` lÃ  há»£p Ä‘á»“ng mÃ  táº§ng `Application` sáº½ implement.  
TÃ¹y má»¥c tiÃªu sá»­ dá»¥ng, interface cÃ³ thá»ƒ káº¿ thá»«a tá»«:

| Base Interface                  | Khi nÃ o nÃªn dÃ¹ng?                          |
|---------------------------------|--------------------------------------------|
| `IApplicationService`           | Khi logic Ä‘a dáº¡ng, khÃ´ng chá»‰ CRUD          |
| `ICrudAppService<TDto, TKey>`   | Khi chá»‰ cáº§n há»— trá»£ CRUD theo kiá»ƒu máº·c Ä‘á»‹nh |

#### âœ… Quy táº¯c:
- âœ… Interface nÃªn káº¿ thá»«a `IApplicationService` hoáº·c `ICrudAppService` tÃ¹y trÆ°á»ng há»£p
- âœ… TÃªn chuáº©n: `I[Entity]AppService`
- âœ… KhÃ´ng khai bÃ¡o body (khÃ´ng cÃ³ `{}`), khÃ´ng xá»­ lÃ½ logic
- âŒ KhÃ´ng táº¡o interface chá»‰ Ä‘á»ƒ Ä‘á»‹nh danh, khÃ´ng cÃ³ method nÃ o

ğŸ“Œ VÃ­ dá»¥:

```csharp
// DÃ¹ng IApplicationService náº¿u cáº§n logic tÃ¹y chá»‰nh
public interface IOrderAppService : IApplicationService
{
    Task<OrderDto> GetAsync(Guid id);
}

// DÃ¹ng ICrudAppService náº¿u chá»‰ cáº§n CRUD
public interface IProductAppService : ICrudAppService<ProductDto, Guid>
{
}
```

ğŸ“Œ ÄÆ°á»£c implement táº¡i táº§ng Application:

```csharp
public class OrderAppService : ApplicationService, IOrderAppService
{
    public async Task<OrderDto> GetAsync(Guid id) => ...;
}

public class ProductAppService : CrudAppService<Product, ProductDto, Guid>, IProductAppService
{
    public ProductAppService(IRepository<Product, Guid> repo) : base(repo) { }
}
```

### ğŸ§¾ Using Ä‘Ãºng namespace

Cáº§n `using` Ä‘Ãºng cÃ¡c namespace sau Ä‘á»ƒ truy cáº­p Setting, Localization

| Loáº¡i dá»¯ liá»‡u          | Namespace máº«u                                               |
|-----------------------|-------------------------------------------------------------|
| Setting name constant | `Aqt.CoreOracle.Settings`                                   |
| Localization Resource | `Aqt.CoreOracle.Localization`                               |

ğŸ“Œ VÃ­ dá»¥:
```csharp
using Aqt.CoreOracle.Permissions;
using Aqt.CoreOracle.Settings;
using Aqt.CoreOracle.Localization;
```

## Examples

### âœ… VÃ­ dá»¥ Ä‘Ãºng

// ğŸ“¦ AppService interface
namespace Aqt.CoreOracle.Application.Contracts.Orders;

public interface IOrderAppService : IApplicationService
{
    Task<OrderDto> GetAsync(Guid id);
}

// ğŸ“‘ DTO
namespace Aqt.CoreOracle.Application.Contracts.Orders.Dtos;

public class OrderDto
{
    public Guid Id { get; set; }
    public string Code { get; set; }
}

// ğŸ” Permission name
namespace Aqt.CoreOracle.Application.Contracts.Orders.Permissions;

public static class OrderPermissions
{
    public const string GroupName = "Orders";
    public const string View = GroupName + ".View";
}

### âŒ VÃ­ dá»¥ sai

// âŒ DTO khÃ´ng cÃ³ háº­u tá»‘
public class Order { public Guid Id { get; set; } }

// âŒ Interface chá»©a logic
public interface ICustomerAppService
{
    string GetDefaultName() => "Unknown"; // âŒ KhÃ´ng Ä‘Æ°á»£c implement táº¡i Ä‘Ã¢y
}

// âŒ Repository trong Contracts
public interface IOrderRepository { } // âŒ NÃªn Ä‘áº·t trong Domain
